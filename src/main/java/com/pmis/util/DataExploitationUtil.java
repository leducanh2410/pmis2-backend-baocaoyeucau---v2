package com.pmis.util;

public class DataExploitationUtil {
    public static String getAndFilterString(
            String maKieuDuLieu,
            String loaiDieuKien,
            String tenCot,
            String giaTriLoc
    ) {
        String columnFilter = "";
        switch (maKieuDuLieu) {
            case "KDL-1":
                columnFilter = switch (loaiDieuKien) {
                    case "%V%" -> " AND " + tenCot + " LIKE N'%" + giaTriLoc + "%'";
                    case "V%" -> " AND " + tenCot + " LIKE N'" + giaTriLoc + "%'";
                    case "%V" -> " AND " + tenCot + " LIKE N'%" + giaTriLoc + "'";
                    default -> " AND " + tenCot + " " + loaiDieuKien + " N'" + giaTriLoc + "'";
                };
                break;
            case "KDL-2":
                columnFilter = " AND " + tenCot + " " + loaiDieuKien + " " + giaTriLoc;
                break;
            case "KDL-3":
                columnFilter = " AND " + tenCot + " " + loaiDieuKien + " " + " '" + ConvertUtil.convertDateString(giaTriLoc) + "' ";
                break;
            case "KDL-4":
                columnFilter = " AND " + tenCot + " " + loaiDieuKien + " '" + ConvertUtil.convertDateTimeString(giaTriLoc) + "' ";
                break;
            default:
        }
        return columnFilter;
    }

    public static String getFilterByCol(
            String maKieuDuLieu,
            String loaiDieuKien,
            String nhomDieuKien,
            String tenCot,
            String giaTriLoc
    ) {
        String columnFilter = "";
        switch (maKieuDuLieu) {
            case "KDL-1":
                columnFilter = switch (loaiDieuKien) {
                    case "%V%" ->  " " + nhomDieuKien + " " + tenCot + " LIKE N'%" + giaTriLoc + "%'";
                    case "V%" ->  " " + nhomDieuKien + " " + tenCot + " LIKE N'" + giaTriLoc + "%'";
                    case "%V" ->  " " + nhomDieuKien + " " + tenCot + " LIKE N'%" + giaTriLoc + "'";
                    default ->  " " + nhomDieuKien + " " + tenCot + " " + loaiDieuKien + " N'" + giaTriLoc + "'";
                };
                break;
            case "KDL-2":
                columnFilter =  " " + nhomDieuKien + " " + tenCot + " " + loaiDieuKien + " " + giaTriLoc;
                break;
            case "KDL-3":
                columnFilter =  " " + nhomDieuKien + " " + tenCot + " " + loaiDieuKien + " " + " '" + ConvertUtil.convertDateString(giaTriLoc) + "' ";
                break;
            case "KDL-4":
                columnFilter =  " " + nhomDieuKien + " " + tenCot + " " + loaiDieuKien + " '" + ConvertUtil.convertDateTimeString(giaTriLoc) + "' ";
                break;
            default:
        }
        return columnFilter;
    }
}
